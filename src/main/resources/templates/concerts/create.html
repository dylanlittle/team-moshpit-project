<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Add New Concert Date</title>

    <link rel="stylesheet" href="/main.css" />
    <link rel="stylesheet" href="/navbar.css"/>
    <link rel="stylesheet" href="/theme.css"/>
    <link rel="stylesheet" href="/artist-profile.css"/>

    <script src="/js/concert_create.js" defer></script>
    <th:block th:replace="~{fragments/timezone-script :: timezone-detector}"></th:block>
</head>

<body>
<header class="page-header">
    <div th:insert="~{fragments/navbar :: headerNav}"></div>
</header>

<th:block th:if="${isAdminMode and activeAdminArtist.id == artist.id}">

    <div class="artist-header">
        <div class="artist-header-content">
            <h1 style="margin: 0;">Add New Concert</h1>
            <div class="artist-genre" th:text="${artist.name}">Artist Name</div>
        </div>
    </div>

    <div class="page-layout">
        <div class="left-column"></div>

        <main class="middle-column">
            <div class="box">
                <p th:text="'Artist: ' + ${artist.name}"></p>

                <form th:action="@{/artists/{id}/concerts(id=${artist.id})}"
                      method="post"
                      th:object="${concertForm}"
                      enctype="multipart/form-data">

                    <div class="form-group">
                        <label for="concert-name">Name (optional)</label>
                        <input type="text"
                               id="concert-name"
                               th:field="*{concertName}"
                               placeholder="e.g. Album Release Show">
                    </div>

                    <div class="form-group">
                        <label for="date" class="required-label">Date</label>
                        <input type="date"
                               id="date"
                               th:field="*{concertDate}"
                               required>
                    </div>

                    <div class="form-group">
                        <label for="start-time" class="required-label">Start Time</label>
                        <input type="time"
                               id="start-time"
                               th:field="*{startTime}"
                               required>
                    </div>

                    <div class="form-group">
                        <label for="country" class="required-label">Country</label>
                        <input type="text"
                               id="country"
                               th:field="*{country}"
                               list="countries-list"
                               placeholder="Start typing country name..."
                               autocomplete="off"
                               required>
                        <datalist id="countries-list">
                            <option th:each="country : ${countries}"
                                    th:value="${country}">
                            </option>
                        </datalist>
                    </div>

                    <div class="form-group">
                        <label for="city" class="required-label">City</label>
                        <input type="text"
                               id="city"
                               th:field="*{city}"
                               list="cities-list"
                               placeholder="Start typing city name..."
                               autocomplete="off"
                               required>
                        <datalist id="cities-list"></datalist>
                    </div>

                    <div class="form-group">
                        <label for="venue-name" class="required-label">Venue Name</label>
                        <input type="text"
                               id="venue-name"
                               th:field="*{venueName}"
                               list="venues-list"
                               placeholder="Start typing venue name..."
                               autocomplete="off"
                               required>
                        <datalist id="venues-list"></datalist>
                    </div>

                    <div class="form-group">
                        <label for="venue-address" class="required-label">Address</label>
                        <input type="text"
                               id="venue-address"
                               th:field="*{address}"
                               required>
                    </div>

                    <div class="form-group mb-3">
                        <label for="concert-image">Image</label>
                        <input type="file"
                               id="concert-image"
                               name="image"
                               accept="image/*">
                        <button type="button"
                                id="clearMediaBtn"
                                class="btn-secondary d-none">
                            Remove selected file
                        </button>
                    </div>

                    <div class="form-actions">
                        <a th:href="@{/artists/{id}(id=${artist.id})}"
                           class="btn-cancel">
                            Cancel
                        </a>

                        <button type="submit"
                                id="new-concert-submit"
                                class="btn-primary">
                            Add New Concert
                        </button>
                    </div>

                </form>
            </div>
        </main>

        <div class="right-column"></div>
    </div>
</th:block>

<script>
    const mediaInput = document.getElementById("concert-image");
    const clearBtn = document.getElementById("clearMediaBtn");

    clearBtn.classList.add("d-none");

    mediaInput.addEventListener("change", function () {
        if (mediaInput.files && mediaInput.files.length > 0) {
            clearBtn.classList.remove("d-none");
        } else {
            clearBtn.classList.add("d-none");
        }
    });

    clearBtn.addEventListener("click", function () {
        mediaInput.value = "";
        clearBtn.classList.add("d-none");
    });
</script>

</body>
</html>
