<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8" />
    <title>
        moshpit - search
    </title>
    <link rel="stylesheet" href="/main.css">
    <link rel="stylesheet" href="/navbar.css"/>
    <link rel="stylesheet" href="/theme.css"/>
    <link rel="stylesheet" href="/search-results.css"/>
</head>

<body>
<header class="page-header">
    <div th:insert="~{fragments/navbar :: headerNav}"></div>
</header>
    <main class="search-container">
        <form th:action="@{/search}" method="get" class="search-form">
            <div>
                <label for="query">Search term:</label>
                <input type="text" id="query" name="query" placeholder="Enter name or username" th:value="${query}"
                    required />
            </div>
            <div>
                <label for="type">Search type:</label>
                <select id="type" name="type">
                    <option value="all" th:selected="${type == 'all'}">All</option>
                    <option value="artists" th:selected="${type == 'artists'}">Artists</option>
                    <option value="users" th:selected="${type == 'users'}">Users</option>
                </select>
            </div>
            <div>
                <button type="submit" class="btn">Search</button>
            </div>
        </form>

        <!--    All results-->
        <section th:if="${type == 'all'}" class="search-section">
            <div th:if="${#lists.isEmpty(userResults) and #lists.isEmpty(artistResults)}">
                No results found.
            </div>
            <h2>Artists</h2>
            <p th:block th:switch="${#lists.size(artistResults)}">
                <span th:case="0">No artists found.</span>
                <span th:case="1">Found 1 artist.</span>
                <span th:case="*" th:text="'Found ' + ${#lists.size(artistResults)} + ' artists.'"></span>
            </p>
            <ol class="results-list">
                <li th:each="artist : ${artistResults}">
                    <div
                        th:replace="~{fragments/display-card :: displayCard(${artist.name}, ' artists/' + ${artist.id}, ${artist.avatar} ?: 'https://placehold.co/128', 'Picture of artist')}">
                    </div>
                </li>
                </ol>
                <h2>Users</h2>
            <p th:block th:switch="${#lists.size(userResults)}">
                <span th:case="0">No users found.</span>
                <span th:case="1">Found 1 user.</span>
                <span th:case="*" th:text="'Found ' + ${#lists.size(userResults)} + ' users.'"></span>
            </p>
            <ol class="results-list">
                <li th:each="user: ${userResults}">
                    <div th:replace="~{fragments/display-card :: displayCard(${user.username}, ' users/' + ${user.id},  ${user.avatar} ?: 'https://placehold.co/128', 'Picture of user')}">
                    </div>
                </li>
            </ol>
        </section>

        <!-- Artist results -->
        <section th:if="${type == 'artists'}">
            <h2>Artist results for "&nbsp;
                <span th:text="${query}"></span>&nbsp;"
            </h2>
            <p th:block th:switch="${#lists.size(artistResults)}">
                <span th:case="0">No artists found.</span>
                <span th:case="1">Found 1 artist.</span>
                <span th:case="*" th:text="'Found ' + ${#lists.size(artistResults)} + ' artists.'"></span>
            </p>

            <ol class="results-list">
                <li th:each="artist : ${artistResults}">
                    <div
                        th:replace="~{fragments/display-card :: displayCard(${artist.name}, 'artists/' + ${artist.id}, ${artist.avatar} ?: 'https://placehold.co/128', 'Picture of artist')}">
                    </div>
                </li>
            </ol>
        </section>

        <!--    Users results -->
        <section th:if="${type == 'users'}">
            <h2>User results for "&nbsp;
                <span th:text="${query}"></span>&nbsp;"
            </h2>
            <p2 th:block th:switch="${#lists.size(userResults)}">
                <span th:case="0">No users found.</span>
                <span th:case="1">Found 1 user.</span>
                <span th:case="*" th:text="'Found ' + ${#lists.size(userResults)} + ' users.'"></span>
            </p2>

            <ol class="results-list">
                <li th:each="user: ${userResults}" style="display: flex; justify-content: center;">
                    <div
                        th:replace="~{fragments/display-card :: displayCard(${user.username}, 'users/' + ${user.id}, ${user.avatar} ?: 'https://placehold.co/128', 'Picture of user')}">
                    </div>
                </li>
            </ol>
        </section>
    </main>
</body>

</html>